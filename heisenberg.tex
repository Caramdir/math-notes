\documentclass{ck-article}

\usepackage{math-ag, math-alg}

\newcommand\loopliealg[1]{\mathcal{L}\liealg{#1}}
\newcommand\affliealg[1]{\hat{\liealg{#1}}}
\newcommand\affKMliealg[1]{\widehat{\loopliealg{#1}}}
\DeclareMathOperator\Res{Res}
\DeclareMathOperator\Ind{Ind}
\newcommand\SymGrp[1]{S_{#1}}
\newcommand\triv{{\mathrm{triv}}}
\DeclareMathOperator\Heis{Heis}


\title{Heisenberg algebras}
\author{Clemens Koppensteiner}

\addbibresource{math.bib}

\begin{document}

\maketitle

\section{Heisenberg algebras}

Recall that the \emph{Heisenberg group} is the subgroup of $\GL 3$ consisting of upper triangular matrices of the form
\[
    \begin{pmatrix}
        1 & a & b \\
        0 & 1 & c \\
        0 & 0 & 1
    \end{pmatrix}.
\]
The \emph{Heisenberg Lie algebra} $\mathfrak{h}$ is the corresponding Lie algebra, consisting of matrices of the form
\[
    \begin{pmatrix}
        0 & a & b \\
        0 & 0 & c \\
        0 & 0 & 0
    \end{pmatrix}.
\]
Thus it has a basis given by
\[
    a_1 = 
    \begin{pmatrix}
        0 & 1 & 0 \\
        0 & 0 & 0 \\
        0 & 0 & 0
    \end{pmatrix}, \quad
    a_{-1} = 
    \begin{pmatrix}
        0 & 0 & 0 \\
        0 & 0 & 1 \\
        0 & 0 & 0
    \end{pmatrix}, \quad
    c = 
    \begin{pmatrix}
        0 & 0 & 1 \\
        0 & 0 & 0 \\
        0 & 0 & 0
    \end{pmatrix}
\]
with relations
\[
    [c,\, a_1] = [c,\, a_{-1}] = 0 \quad\text{and}\quad [a_1,\, a_{-1}] = c.
\]
The \emph{Heisenberg algebra} is the enveloping algebra $U(\mathfrak{h})$ of the Heisenberg Lie algebra.
Thus it is the associative algebra with generators $c$, $a_{-1}$ and $a_1$, and the above relations.
The elements $c$ (sometimes denoted $z$ or $\hbar$) is central.
From now on we often set $c = 1$.

\begin{Remark}
    The Heisenberg algebra modulo $c = 1$ is exactly the (1-dimensional) Weyl algebra (which is usually written with generators $x$ and $\partial_x$).
\end{Remark}

\subsection{The infinite dimensional Heisenberg algebra}\label{sec:infinite_Heisenberg}

Generalizing the above definition, one obtains higher dimensional analogues, and eventually the \emph{infinite Heisenberg Lie algebra} which is generated by $a_n$ for $n \in \ZZ \setminus \{0\}$ and central element $c$ with relations
\[
    [a_m,\, a_n] = \delta_{m,-n}c.
\]
The \emph{infinite Heisenberg algebra} is the enveloping algebra of this Lie algebra.

There are several variants of this construction:
\begin{itemize}
    \item The relations are often scaled as $[a_m,\, a_n] = m\delta_{m,-n}c$, or $[a_m,\, a_n] = n\delta_{m,-n}c$.
    % [CL,2.2.1] Have $n\delta_{m,-n}$ instead. So there might be a sign in the corresponding expressions for p and q below.
    \item A common labeling of the generators is $p_n = a_n$, $q_n = a_{-n}$ for $n \ge 1$, but we will use these letters for a different set of generators below.
    \item \cite[Definition~4.1]{Gordon:2009:InfiniteDimensionalLieAlgebras} adds an additional generator $a_0$, satisfying the same relations. Thus in this case the Heisenberg Lie algebra is a central extension of the loop Lie algebra of a 1-dimensional abelian Lie algebra.
    \item We often identify the \emph{central charge} $c$ with $1$.
\end{itemize}

% polynomials, symmetric groups

\subsection{Heisenberg algebras associated to a bilinear form}

Given a vector space $V$ with a symmetric bilinear form $\chi\colon V \times V \to V$.
Consider $L_V = V^{\ZZ \setminus \{0\}}$ and denote by $a_{v}(n)$ the image of $v \in V$ in the $n$th summand of $L_V$.
The (infinite) Heisenberg algebra $H_V$ of $(V, \chi)$ is the quotient of the tensor algebra $T(L_V) = \bigoplus_{i \ge 0} L_V^{\otimes i}$ by the relations
\[
    [a_v(m),\, a_w(n)] = m\chi(v,w)\delta_{m,-n}.
\]
\begin{Remarks}
    Again, there are renormalized versions where the left hand side of the relations do not contain the factor $m$, or differ by a sign.
    Similarly, one can again add a central element $c$.

    If $\chi$ is degenerate, then $H_V$ has a non-trivial center.
    Thus one often assumes $\chi$ to be non-degenerate.
\end{Remarks}

\begin{Example}
    If $V = k$ with inner product given by multiplication, one recovers the infinite Heisenberg algebra of Section~\ref{sec:infinite_Heisenberg}.
\end{Example}

% finite-dimensional Heisenberg Lie-algebra.

\subsection{Heisenberg algebras associated to a Dynkin diagram}\label{sec:heisenberg:Dynkin}

Let $\Gamma = (I, E)$ be a simply laced Dynkin diagram with vertices $I$ and edges $E$.
Consider the vector space $V = k^I$.
The Cartan matrix of $\Gamma$ defines a symmetric linear form on $V$:
\[
    \chi(i,j) =
    \begin{cases}
        \phantom{-}2 & \text{if } i = j, \\
        -1 & \text{if } i \ne j \text{ are connected by an edge}, \\
        \phantom{-}0 & \text{if } i \ne j \text{ are not connected by an edge.} \\
    \end{cases}
\]
The Heisenberg algebra of $\Gamma$ is $H_\Gamma = H_V$.

% More general situation?

\subsection{The Fock space}

Let $(V,\psi)$ be a vector space endowed with a symmetric bilinear form and let $H = H_V$ be the associated Heisenberg algebra with generators $a_v(n)$ with relation
\[
    [a_v(m),\, a_w(n)] = m\psi(v,w) \delta_{m,-n}.
\]
The \emph{Fock space representation} of $H$ is the quotient $F = H/I$, where $I$ is the left ideal generated by all $a_v(n)$ for $n > 0$.

Alternatively, let $H^+$ be the subalgebra generated by $a_v(n)$, $n \ge 0$, and let $\triv_0$ be the trivial representation of $H^+$ where all $a_i(n)$ act by $0$ (and if it exists, $a_v(0)$ acts as the identity[?]).
Then $F = \Ind_{H^+}^H(\triv_0)$.

Explicitly for $n > 0$, $a_v(-n)$ acts on $F$ by multiplication (called a \emph{creation operator}).
One computes that the \emph{annihilation operator} $a_v(n)$ acts by $a_v(n) \cdot a_w(-m) = m\delta_{n,m}\psi(v,w)1$.
The element $1 \in H$ is called the \emph{vacuum vector} and $H \cdot 1 = F$.

\begin{Example}
    If $\dim V = 1$, one can identify $F$ with the polynomial ring $k[x_1,x_2,\dots]$ in infinitely many variables via $a(-n) \mapsto x_n$.
    Thus $a(-n)$ acts by multiplication with $x_n$ and $a(n) \cdot x_i = n\delta_{n,i}$. [write down action on $x_i^k$?]
\end{Example}


\subsection{A different set of generators}

\subsection{Idempotent modification}

\section{The Frenkel--Kac construction}

The Frenkel--Kac constructions constructs the basic representation of an affine Lie algebra from the Fock space representation of a Heisenberg algebra.

\subsection{Affine Lie algebras}

Let $\liealg g$ be a complex simple finite dimensional Lie algebra with a choice of Cartan $\liealg h$ and positive roots $\Delta_+ \subset \Delta$.
Let $\kappa$ be the Killing form of $\liealg g$.

The vector space $\loopliealg g = \CC[t, t^-1] \otimes_\CC \liealg g$ has a Lie bracket defined by 
\[
    \bigl[ p \otimes X,\, q \otimes Y\bigr] = pq \otimes [X,\,Y].
\]
It is called the \emph{loop algebra} of $\liealg g$.
The Killing form $\kappa$ extends to a $\CC[t,t^{-1}]$-valued form on $\loopliealg g$.

The loop algebra has a unique central extension \cite[Theorem~10.2]{Gordon:2009:InfiniteDimensionalLieAlgebras}.
It is given by the \emph{affine Lie algebra} $\affliealg g = \loopliealg g \oplus \CC c$ with bracket
\[
    \bigl[p \otimes X + \alpha c,\, q \otimes Y + \beta c\bigr]  =
    [p\otimes X,\, q \otimes Y] + \Res\biggl(\frac{dp}{dt}q\biggr)\kappa(X,Y)c,
\]
where $\Res$ denotes the residue of a Laurent polynomial (i.e.~the coefficient of $t^{-1}$).
More explicitly,
\[
    \bigl[p \otimes t^m + \alpha c,\, q \otimes t^n + \beta c\bigr]  =
    t^{m+n} \otimes [X,\, Y] + m\delta_{m,-n}\kappa(X,Y)c.
\]
The Lie algebra $\affliealg g$ admits a derivation $d$ which acts by
\[
    d\bigl(p \otimes X + \alpha c) = t\frac{dp}{dt} \otimes X.
\]
One sometimes enlarges $\affliealg g$ by a semidirect product with $\CC d$ such that
\[
    [d, A] = d(A).
\]
The resulting Lie algebra is called the \emph{affine Kac--Moody Lie algebra} $\affKMliealg g$.

\subsection{The homogeneous Heisenberg subalgebra}

Either of the two subalgebras of $\affliealg g$
\begin{align*}
    \hat{\liealg s} & = \sum_{k \in \ZZ \setminus 0} (t^k \otimes_\CC \liealg h) \oplus \CC c\\
    \intertext{and}
    \tilde{\liealg s} & = \CC[t,t^{-1}] \otimes_\CC \liealg h \oplus \CC c
\end{align*}
are called a \emph{homogeneous Heisenberg subalgebra}.

We note that up to rescaling and a choice of positive roots, the Cartan matrix of the Dynkin diagram $\Gamma$ of $\liealg g$ induces the same symmetric bilinear form on $\liealg h$ as the Killing form.
Thus $\hat{\liealg s}$ is isomorphic to the Heisenberg algebra $H_\Gamma$ of Section~\ref{sec:heisenberg:Dynkin}.

\subsection{Vertex operators}

Let $F$ be the Fock space of $\hat{\liealg s}$ and $Y$ be the root lattice of $\liealg g$.
We set
\[
    V = F \otimes_\CC \CC_\epsilon(Y) \cong \bigoplus_{\lambda \in Y} F.
\]
Here $\CC_\epsilon(Y)$ is the group algebra of $Y$, with multiplication twisted by a sign [Why?].
Write $e_\lambda$ for the generators of $\CC(Y)$.

The goal is to give $V$ the structure of a representation of $\affliealg g$.
To do so we introduce \emph{vertex operators}.
Specifically, we consider the formal sum
\begin{equation}\label{eq:vertex_operators}
    X(i, z) = e_{\alpha_i} z^{\alpha_i}
    \exp\biggl(\sum_{n=1}^\infty \frac{z^n}{n} a_i(-n)\biggr)
    \exp\biggl(-\sum_{n=1}^\infty \frac{z^{-n}}{n} a_i(n)\biggr).
\end{equation}
Here $a_i(n) \in \hat{\liealg s}$ are the generators arising from the presentation as $H_\Gamma$ and $\alpha_i$ are the simple roots corresponding to the vertices of the Dynkin diagram $\Gamma$.
The operator $z^{\alpha_i}$ takes any element of the space $F \otimes e_\lambda$ to the monomial $z^{\langle \alpha_i, \lambda\rangle}$.

\begin{Remark}
    Formula \eqref{eq:vertex_operators} is taken from Wikipedia\footnote{\url{https://en.wikipedia.org/wiki/Vertex_operator_algebra\#Vertex_operator_algebra_defined_by_an_even_lattice}}.
    It seems to me that compared to \cite[Equation~(2.23)]{FrenkelKac:1980:BasicRepresentationsOfAffineLieAlgebras} it is off by a factor of $z$.
\end{Remark}

Write
\[
    X(i, z) = \sum_{k \in \ZZ} X_k(i) z^k.
\]
Defining the action of $E_{i,m} \in \affliealg g$ on $V$ to be $X_m(i)$ gives $V$ the structure of a $\affliealg g$-representation.
As such it is isomorphic to the basic representation $V_{\Lambda_0}$.
For details see \cite[Theorem~1]{FrenkelKac:1980:BasicRepresentationsOfAffineLieAlgebras}.

\begin{Remark}
    Starting from an arbitrary even lattice one can apply the same construction with the associated Heisenberg algebra and Fock space and still obtain vertex operators.
    Of course in general they will not give a representation of an affine Lie algebra.
\end{Remark}

\subsection{Virasoro operators}

Fix an orthonormal basis $h_1,\dotsc, h_n$ of $\liealg h$ and let $h_i(m)$ be the corresponding generators for $\tilde{\liealg s}$.
Define operators
\begin{align*}
    D_0 &= -\sum_{k \ge 1} \sum_{i=1}^n h_i(-k)h_i(k) - \frac12\sum_{i=1}^n h_i(0)^2 \\
    \intertext{and}
    D_m &= -\frac12 \sum_{k \in \ZZ} \sum_{i=1}^n h_i(-k)h_i(k+m)& \text{for } m \in \ZZ \setminus 0
\end{align*}
acting on $V$.
These operators induce an action of the Virasoro algebra on $V$ \cite[Proposition~2.7]{FrenkelKac:1980:BasicRepresentationsOfAffineLieAlgebras}.

\section{Virasoro operators and W-algebras}

\section{The Heisenberg double}

\subsection{Positive self-adjoint Hopf algebras}

\begin{Definition}
    A \emph{positive self-adjoint Hopf algebra}, or \emph{PSH}, is a connected graded Hopf algebra over $\ZZ$ with an inner product and a distinguished finite orthogonal $\ZZ$-basis in each grade such that multiplication and comultiplication are adjoint and take elements with positive coefficients in the basis to elements with positive coefficients in the basis.
\end{Definition}

\subsubsection{Symmetric functions}

We let
\[
    \Lambda = \varprojlim_{n \to \infty} k[x_1,\dotsc,x_n]^{\SymGrp n}
\]
be the algebra of symmetric functions\footnote{\url{https://mathoverflow.net/a/85990} contains many references. See also \url{https://www.math.upenn.edu/~peal/polynomials}}.
We have isomorphisms
\[
    \Lambda \cong 
    \bigoplus_{n=0}^\infty Z(\CC[\SymGrp n]) \cong
    \bigoplus_{n=0}^\infty K_0(\catModules{\CC[\SymGrp n]}),
\]
where $Z(\CC[\SymGrp n])$ is the center of the group ring of $\SymGrp n$ and $K_0(\catModules{\CC[\SymGrp n]})$ is the Grothendieck ring of finite dimensional $\SymGrp n$-representations.

The algebra $\Lambda$ has several well-known generating sets:
\begin{itemize}
    \item The \emph{elementary symmetric functions} 
        \[
            e_n = \sum_{i_1 < \dots < i_n} x_{i_1} \dotsm x_{i_n}.
        \]
        Thus $e_0 = 1$, $e_1 = x_1 + x_2 + \dots$, $e_2 = x_1x_2 + x_1x_3 + \dots + x_2x_3  + \dots$.
    \item The \emph{complete symmetric functions} 
        \[
            h_n = \sum_{i_1 \le \dots \le i_n} x_{i_1} \dotsm x_{i_n}.
        \]
        Thus $h_0 = 1$, $h_1 = x_1 + x_2 + \dots$, $h_2 = x_1^2 + x_1x_2 + x_1x_3 + \dots + x_2^2 + x_2x_3  + \dots$.
    \item For any partition $\lambda$ define the \emph{symmetric monomial}
        \[
            m_\lambda = \sum_{\alpha} x^\alpha,
        \]
        where $\alpha$ runs through all multiindices conjugate to $\lambda$ under the $\SymGrp\infty$-action.
        The symmetric monomials generate $\Lambda$ as a free $k$-module.
    \item For any partition $\lambda$ define the \emph{Schur function} (or \emph{S-function})
        \[
            s_\lambda = \sum_T x^{\operatorname{wt} T},
        \]
        where $T$ runs through all semistandard\footnote{A Young tableau is \emph{semistandard} if its entries increase weakly along the rows and strictly along the columns.} Young tableaux $T$ with $\ZZ_{>0}$-entries of shape $\lambda$, and $\operatorname{wt}(T)$ is the weight vector of $T$, i.e., $\operatorname{wt}(T)_i$ is the number of times $i$ appears in $T$.
        The Schur functions generate $\Lambda$ as a free $k$-module.
    \item The \emph{power sum functions}
        \[
            p_n = \sum_i x_i^n.
        \]
        Note that these generate over $k = \QQ$, but not over $k=\ZZ$.
        For a partition $\lambda = (\lambda_1,\dots,\lambda_k)$ set
        \[
            p_\lambda = p_{\lambda_1}\dotsm p_{\lambda_k}.
        \]
\end{itemize}
On defines a comultiplication on $\Lambda$ by
\[
    \Delta(e_n) = \sum_{i=0}^n e_i \otimes e_{n-i}
\]
and a counit by $\epsilon(e_n) = 0$ for $n \ge 0$ (i.e., projection on the constant term).
The power sum functions are primitive:
\[
    \Delta(p_i) = p_{i} \otimes 1 + 1 \otimes p_i.
\]
From this one can deduce the coalgebra structure (over $\QQ$):
\[
    \Delta(p_{i_1}\dotsm p_{i_n}) =
    \sum_{\{j_1,\dots,j_k\} \sqcup \{\ell_1, \dots, \ell_{n-k}\} = \{i_1,\dots,i_n\}} p_{j_1}\dotsm p_{j_k} \otimes p_{\ell_{1}}\dotsm p_{\ell_{n-k}}.
\] 
Further $\Lambda$ obtains the structure of graded (by degree) Hopf algebra with a antipode $S$ satisfying $S(e_n) = (-1)^n h_n$ and $S(p_n) = -p_n$.

The Hopf algebra $\Lambda$ has a standard inner product, called \emph{Hall inner product}, which is characterized by having the Schur functions as an orthonormal basis:
\[
    \langle s_\lambda, s_\mu\rangle = \delta_{\lambda,\mu}.
\]
The power sum functions also provide an orthogonal basis with
\[
    \langle p_\lambda, p_\mu\rangle = z_\lambda\delta_{\lambda,\mu},
\]
where if $m_i$ is the number of parts of size $i$ in $\lambda$ then $z_\lambda = \prod_i m_i!i^{m_i}$.
% Relations to S_n-reps

\subsection{Heisenberg double}

Given a PSH $A$ and an element $x \in A$, define $m_x$ and $\Delta_x$ in $\End(A)$ by
\[
    m_x = m \circ i_x \qquad \Delta_x = j_x \circ \Delta,
\]
where
\[
    i_x(y) = x \otimes y \qquad j_x(y_1 \otimes y_2) = y_x \langle x, y_1 \rangle.
\]
One immediately checks that $m_x$ and $\Delta_x$ are adjoint.
Define a map $\phi\colon A \otimes A \to \End_\ZZ(A)$ by
\[
    x \otimes y \mapsto m_x\Delta_y.
\]
The morphism $\phi$ is injective and its image is a subalgebra of $\End_\ZZ(A)$, called the \emph{Heisenberg double $\Heis(A)$ of $A$} \cite[Proposition~5.4]{GalGal:2017:SymmetricSelfajointHopfCategories}.

\begin{Example}
    Let $A = \Lambda$ be the Hopf algebra of symmetric functions.
    Then $\Lambda$ with the Hall inner product and Schur functions as basis is a PSH [proof?].
    The Heisenberg double $\Heis(\Lambda)$ is the infinite dimensional Heisenberg algebra.
    Indeed setting $a_n = \phi(1 \otimes p_n)$ and $a_{-n} = \phi(p_n \otimes 1)$ for $n \ge 0$ one computes that $[a_i, a_j] = i\delta_{i,-j}$.
\end{Example}

\section{Quantum versions}

\printbibliography

\end{document}
